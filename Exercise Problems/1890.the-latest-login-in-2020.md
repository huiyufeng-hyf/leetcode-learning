**https://leetcode.cn/problems/the-latest-login-in-2020/description/**

- Solution by MS SQL
```
/* Write your T-SQL query statement below */
WITH CTE AS (
    SELECT *, 
        ROW_NUMBER() OVER(PARTITION BY user_id ORDER BY time_stamp DESC) AS rn
    FROM Logins
    WHERE time_stamp >= '2020-01-01' AND time_stamp < '2021-01-01'
)
SELECT user_id, time_stamp as 'last_stamp'
FROM CTE
WHERE rn = 1;
```

---

- Refined the MS Sql by using year function
```
/* Write your T-SQL query statement below */
WITH CTE AS (
    SELECT *, 
        ROW_NUMBER() OVER(PARTITION BY user_id ORDER BY time_stamp DESC) AS rn
    FROM Logins
    WHERE YEAR(time_stamp) = 2020
)
SELECT user_id, time_stamp as 'last_stamp'
FROM CTE
WHERE rn = 1;
```

---

- Recommendation in Pandas
```
import pandas as pd

def latest_login(logins: pd.DataFrame) -> pd.DataFrame:
    logins = logins[(logins["time_stamp"] >= "2020-01-01") & (logins["time_stamp"] < "2021-01-01")]
    return logins.groupby("user_id", as_index=False).agg(last_stamp=("time_stamp", "max"))
    
```
