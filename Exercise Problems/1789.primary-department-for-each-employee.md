https://leetcode.cn/problems/primary-department-for-each-employee/description/ 

- Recommendation by copilot
```
/* Write your T-SQL query statement below */
with CTE as (
    select 
        e.employee_id,
        e.department_id,
        ROW_NUMBER() over (
            PARTITION BY e.employee_id order by e.primary_flag desc, e.department_id
        ) as rn
    from Employee e
)
select employee_id, department_id
from CTE
where rn = 1
```

---

- Recommendation in Pandas
```
import pandas as pd

def find_primary_department(employee: pd.DataFrame) -> pd.DataFrame:
    cnt = employee.groupby("employee_id", as_index=False).agg(
        dep_cnt=("department_id", "count")
    )
    df = pd.merge(employee, cnt)
    return df[(df["primary_flag"] == 'Y') | (df["dep_cnt"] == 1)].drop_duplicates()[["employee_id", "department_id"]]
    
```
